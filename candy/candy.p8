pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
-- sugarush
-- by thomas michael wallace

state=0--0:intro 1:game 2:end

ani={
 t=0,--count
 k=false,--tick
 r=4,--frame rate
 h=false,
}

you={
	x=0,--x position
	y=88,--/y
	v=0,--velocity
	s=1,--sprite
}

lvl={
 w=0,--wait until next
}

actors={}

function _init_game()
 --reset
 actors={}
 you.x=60
 you.v=2
 --start
 state=1
end

function _update_screen()
 if(btnp(0)or btnp(1))_init_game()
end

function _draw_screen()
 cls()
 if(state==0)then
  print("sugarrush")
 else
  print("gameover")
 end
 print("⬅️/➡️ to start")
end

function _update_game()
 --movement
 if(btn(0))you.x-=you.v
 if(btn(1))you.x+=you.v
 you.x=mid(0,you.x,120)
 --animation
 ani.t+=1
 ani.k=(ani.t>ani.r)
 if(ani.k)then
  you.s+=1
  if(you.s>2)you.s=1
  ani.t=0
 end 
 --actors
 for a in all(actors) do
  a:_update()
		if(a.y>you.y and a.y<(you.y+8))then
		 if(a.x>(you.x-8) and a.x<(you.x+8))then
		 	state=2
		 end
		end
 end
 --spawn
 lvl.w-=1
 if(lvl.w<0)then
  add_banana()
  lvl.w=30
 end
end

function _draw_game()
 cls()
 --player
 spr(you.s,you.x,you.y)
 --actors
 for a in all(actors) do
  a:_draw()
 end
end

function _update()
 if(state==1)then
  _update_game()
 else
  _update_screen()
 end
end

function _draw()
 if(state==1)then
  _draw_game()
 else
  _draw_screen()
 end
end
-->8
function add_banana()
 local a={
 	x=flr(rnd(121)),
 	y=-8,
 	s=3,
 	r=0,
 	_draw=function(self)
 	 local fx=(self.r>0 and self.r<3)
   local fy=(self.r>1)
 	 spr(self.s,self.x,self.y,1,1,fx,fy)
 	end,
 	_update=function(self)
 		self.y+=1
 		
 		if(ani.k)self.r+=1
 		if(self.r>3)self.r=0
 		if(self.y>128)del(actors,self)
 	end
 }
 add(actors,a)
end
__gfx__
000000000787878000ffff00000000000bb003300000000000bbb000000000000000000000000000000000000000000000000000000000000000000000000000
0000000008888880087878700400000033bbb3bb00fff444008b8800000000000000000000000000000000000000000000000000000000000000000000000000
00700700f888888ff888888f0aa000003bb3bbb3f44ff4ff08ee8880000000000000000000000000000000000000000000000000000000000000000000000000
00077000f878787ff787878faaa00000bbb33b3bf4ffffff8ee88888000000000000000000000000000000000000000000000000000000000000000000000000
00077000ffffffffffffffffaaaa00000b3bbb30fffffff48e888888000000000000000000000000000000000000000000000000000000000000000000000000
00700700f75ff57ff57ff75f0aaaaa0000033000f4fff4f488888888000000000000000000000000000000000000000000000000000000000000000000000000
00000000f77444444444477f04aaaa40000bb000044f4f0008888880000000000000000000000000000000000000000000000000000000000000000000000000
000000000444444004444440000aa000000bb0000000000000888800000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000099900000ccc00000ddd00000888000003330000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000009a999000c7ccc000d6ddd0008e8880003b333000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000099999000ccccc000ddddd0008888800033333000000000000000000000000000000000000000000000000000000000000000000
000000000000000000000000099999000ccccc000ddddd0008888800033333000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000099900000ccc00000ddd00000888000003330000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000044440000099900000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000455400009a9990000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000045440000999990000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000077e77e77e77e77e0000000000044440000999990000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000aaaaaaaaaaaaaaa0000000000044444444099900000000000000000000000000000000000000000000
009990000088800000ddd00000ccc00000333000000000aaaaaaaaaaaaaaa0000000000045544554000000000000000000000000000000000000000000000000
09a99900089888000deddd000c6ccc0003b33300000000aaaaaaaaaaaaaaa0000000000045444544000000000000000000000000000000000000000000000000
09999900088888000ddddd000ccccc00033333000000007777777777777770000000000044444444000000000000000000000000000000000000000000000000
09999900088888000ddddd000ccccc0003333300000000eeeeeeeeeeeeeee0000000000044444444000000000000000000000000000000000000000000000000
009990000088800000ddd00000ccc00000333000000000eeeeeeeeeeeeeee0000000000045544554000000000000000000000000000000000000000000000000
0007000000070000000700000007000000070000000000eeeeeeeeeeeeeee0000000000045444544000000000000000000000000000000000000000000000000
0007000000070000000700000007000000070000000000eeeeeeeeeeeeeee0000000000044444444000000000000000000000000000000000000000000000000
00070000000700000007000000070000000700000000007777777777777770000000000066666666000000000000000000000000000000000000000000000000
0007000000070000000700000007000000070000000000fffffffffffffff00055555555e888888e000000000000000000000000000000000000000000000000
0007000000070000000700000007000000070000000000fffffffffffffff00007777770e8eeee8e000000000000000000000000000000000000000000000000
0007000000070000000700000007000000070000000000fffffffffffffff00055555555e888888e000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000e8ee888e000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000e888888e000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000e888888e000000000000000000000000000000000000000000000000
000000000000000000000000000000000000000000000000000000000000000000000000eeeeeeee000000000000000000000000000000000000000000000000
__gff__
0000000101010100000000000000000000000002020202020000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
0000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
