pico-8 cartridge // http://www.pico-8.com
version 29
__lua__
--the cards strike twelve
--by thomas michael wallace

cs={}

function _init()
 cs={
  i=1,
	 c={},
	 t=0,
	 o=false,--over
	 w=false,--won
	 v=0,--last v
 }
 for i=1,3 do
  add_card()
 end
end

function add_card()
 local d={
  {s=4,v= 1,t="+1"},
  {s=5,v= 3,t="+3"},
  {s=6,v= 5,t="+5"},
  {s=7,v=-2,t="-2"},
  {s=8,v=-4,t="-4"},
 }
 local n=cs.v
 while(n==cs.v)do
  n=flr(rnd(#d))+1
 end
 cs.v=n
 add(cs.c,d[n])
end

function _update()
 if(cs.o)then
  if(btnp(4)or btnp(5))_init()
  return
 end
 if(cs.i<0)return
 if(btnp(0))cs.i-=1
 if(btnp(1))cs.i+=1
 if(btnp(4)or btnp(5))then
  local c=cs.c[cs.i]
  del(cs.c,c)
  cs.t+=c.v
  if(cs.t>=12)then
   cs.o=true
   cs.w=cs.t==12
  end
  cs.t%=12
  add_card()
 end
 cs.i=mid(cs.i,1,#cs.c)
end

function _draw()
 cls(1)
 --draw_opp()
 draw_clock(64,32)
 draw_cards()
 if(cs.o)draw_dia()
end
-->8
--text

function printc(t,y,c)
 local x=(128-#t*4)/2
 print(t,x,y,c)
end

function draw_dia()
 --layout
 local w=128-32
 local h=128-100
 w,h=(128-w)/2,(128-h)/2
 --outline
 rectfill(w,h,128-w,128-h,0)
 w,h=w+1,h+1
 rect(w,h,128-w,128-h,7)
 --content
 local y=h+3
 printc("gameover",y,7)
 y+=8
 if(cs.w)then
  printc("you win =d",y,11)
 else
  printc("you lose =(",y,8)
 end
 y=128-h-7
 printc("press ❎ to play again",y,5)
 return true
end

-->8
--graphics

function draw_card(ox,oy,os,t)
 local x,y,s=ox,oy,os
 spr(1 ,x   ,y,2,1)
 spr(2 ,x+16,y,2,1)
 y+=8
 spr(17,x   ,y,2,1)
 spr(s ,x+16,y,1,1)
 spr(19,x+24,y,1,1)
 y+=8
 spr(17,x   ,y,2,1)
 spr(18,x+16,y,2,1)
 y+=8
 spr(17,x   ,y,2,1)
 spr(18,x+16,y,2,1)
 y+=8
 --s+=16
 spr(17,x   ,y,2,1)
 spr(s ,x+7 ,y+1,1,1)
 spr(18,x+16,y,2,1)
 y+=8
 spr(33,x   ,y,2,1)
 spr(34,x+16,y,2,1) 
 print(t,x+13,oy+21,0)
end

function draw_cards()
 local oy,dx=76,36
 local ox=(128-((#cs.c-1)*dx+4*8))/2
 local x,y=ox,oy
 for i,c in ipairs(cs.c) do
  if(i~=cs.i)then
	  draw_card(x,y,c.s,c.t)
	 end
	 x+=dx
 end
 if(cs.i>0)then
	 x,y=ox+(cs.i-1)*dx,y-16
	 local c=cs.c[cs.i]
	 draw_card(x,y,c.s,c.t)
	end
end

function draw_clock()
 local cx,cy,r=64,32+4,32
 local t=cs.t%12
 if(t==0)t=12
 circ(cx,cy,r,7)
 r-=2
 local xf={0,0.5,0.866,1}
 local yf={1,0.866,0.5,0}
 --        1  2  3  4  5  6  7  8  9  10 11 12
 local xs={2 ,3 ,4 ,3 ,2 ,1 ,-2,-3,-4,-3,-2, 1}
 local ys={-2,-3,4 ,3 ,2 ,1 , 2, 3, 4,-3,-2,-1}
 local x=cx+r*sgn(xs[t])*xf[abs(xs[t])]
 local y=cy+r*sgn(ys[t])*yf[abs(ys[t])]
 line(cx,cy,x,y,8)
end
__gfx__
00000000000777777777777777777000777888777778887777788877777888777778887777788877000000000000000000000000000000000000000000000000
00000000077888888888888888888770778787877787878777878787778777877787778777878787000000000000000000000000000000000000000000000000
00700700078878787878787878787870787788787877877878778778787877787877777878778788000000000000000000000000000000000000000000000000
00077000788787878787878787878787787787787877888878778778787787787877877878778878000000000000000000000000000000000000000000000000
00077000787877777777777777777887787777787877777878777878787777787888777878777778000000000000000000000000000000000000000000000000
00700700788777777777777777778787778777877787778777877787778777877787778777877787000000000000000000000000000000000000000000000000
00000000787877777777777777777887777888777778887777788877777888777778887777788877000000000000000000000000000000000000000000000000
00000000788777777777777777778787777777777777777777777777777777777777777777777777000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787877777777777777777887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000788777777777777777778787000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000787878787878787878787887000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000078787878787878787878870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000077888888888888888888770000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000777777777777777777000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078888888870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078878787870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078787878870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078878787870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078787878870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078878787870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078787878870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078878787870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078787878870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078878787870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00078888888870000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
00007777777700000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000000
__label__
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111777777777771111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111117777111111111117777111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111117771111111111111111111777111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111771111111111111111111111111771111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111177111111111111111111111111111117711111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111711111111111111111111111111111111171111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111177111111111111111111111111111111111117711111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111711111111111111111111111111111111111111171111111111111111111111111111111111111111111
11111111111111111111111111111111111111111117111111111111111111111111111111111111111117111111111111111111111111111111111111111111
11111111111111111111111111111111111111111171111111111111111111111111111111111111111111711111111111111111111111111111111111111111
11111111111111111111111111111111111111111711111111111111111111111111111111111111111111171111111111111111111111111111111111111111
11111111111111111111111111111111111111117111111111111111111111111111111111111111111111117111111111111111111111111111111111111111
11111111111111111111111111111111111111171111111111111111111111111111111111111111111111111711111111111111111111111111111111111111
11111111111111111111111111111111111111711111111111111111111111111111111111111111111111111171111111111111111111111111111111111111
11111111111111111111111111111111111111711111111111111111111111111111111111111111111111111171111111111111111111111111111111111111
11111111111111111111111111111111111117111111111111111111111111111111111111111111111111111117111111111111111111111111111111111111
11111111111111111111111111111111111171111111111111111111111111111111111111111111111111111111711111111111111111111111111111111111
11111111111111111111111111111111111171111111111111111111111111111111111111111111111111111111711111111111111111111111111111111111
11111111111111111111111111111111111711111111111111111111111111111111111111111111111111111111171111111111111111111111111111111111
11111111111111111111111111111111111711111111111111111111111111111111111111111111111111111111171111111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111118888888888888888888888888888888171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111711111111111111111111111111111111111111111111111111111111111111171111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111171111111111111111111111111111111111111111111111111111111111111711111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111117111111111111111111111111111111111111111111111111111111111117111111111111111111111111111111111
11111111111111111111111111111111111711111111111111111111111111111111111111111111111111111111171111111111111111111111111111111111
11111111111111111111111111111111111711111111111111111111111111111111111111111111111111111111171111111111111111111111111111111111
11111111111111111111111111111111111171111111111111111111111111111111111111111111111111111111711111111111111111111111111111111111
11111111111111111111111111111111111171111111111111111111111111111111111111111111111111111111711111111111111111111111111111111111
11111111111111111111111111111111111117111111111111111111111111111111111111111111111111111117111111111111111111111111111111111111
11111111111111111111111111111111111111711111111111111111111111111111111111111111111111111171111111111111111111111111111111111111
11111111111111111111111111111111111111711111111111111111111111111111111111111111111111111171111111111111111111111111111111111111
11111111111111111111111111111111111111171111111111111111111111111111111111111111111111111711111111111111111111111111111111111111
11111111111111111111111111111111111111117111111111111111111111111111111111111111111111117111111111111111111111111111111111111111
11111111111111111111111111111111111111111711111111111111111111111111111111111111111111171111111111111111111111111111111111111111
11111111111111111111111111111111111111111171111111111111111111111111111111111111111111711111111111111111111111111111111111111111
11111111111111111111111111111111111111111117111111111111111111111111111111111111111117177777777777777777777777777111111111111111
11111111111111111111111111111111111111111111711111111111111111111111111111111111111177788888888888888888888888888771111111111111
11111111111111111111111111111111111111111111177111111111111111111111111111111111117717887878787878787878787878787871111111111111
11111111111111111111111111111111111111111111111711111111111111111111111111111111171178878787878787878787878787878787111111111111
11111111111111111111111111111111111111111111111177111111111111111111111111111117711178787777777777777777777777777887111111111111
11111111111111111111111111111111111111111111111111771111111111111111111111111771111178877777777777777777777777778787111111111111
11111111111111111111111111111111111111111111111111117771111111111111111111777111111178787777777777777777777777777887111111111111
11111111111111111111111111111111111111111111111111111117777111111111117777111111111178877777777777777777777777778787111111111111
11111111111111111111111111111111111111111111111111111111111777777777771111111111111178787777777777777778887777777887111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178877777777777777787878777778787111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178787777777777777877877877777887111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178877777777777777877888877778787111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178787777777777777877777877777887111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178877777777777777787778777778787111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178787777777777777778887777777887111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111178877777777777777777777777778787111111111111
11111111111111177777777777777777777777777111111111177777777777777777777777777111111178787777777777777777777777777887111111111111
11111111111117788888888888888888888888888771111117788888888888888888888888888771111178877777777777777777777777778787111111111111
11111111111117887878787878787878787878787871111117887878787878787878787878787871111178787777777777777777777777777887111111111111
11111111111178878787878787878787878787878787111178878787878787878787878787878787111178877777777777777777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777777777777777777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777777777777000777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777777777077770777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777777770007700777777778787111111111111
11111111111178787777777777777778887777777887111178787777777777777778887777777887111178787777777777077770777777777887111111111111
11111111111178877777777777777787778777778787111178877777777777777787778777778787111178877777777777777000777777778787111111111111
11111111111178787777777777777878777877777887111178787777777777777877777877777887111178787777777777777777777777777887111111111111
11111111111178877777777777777877877877778787111178877777777777777877877877778787111178877777777777777777777777778787111111111111
11111111111178787777777777777877777877777887111178787777777777777888777877777887111178787777777777777777777777777887111111111111
11111111111178877777777777777787778777778787111178877777777777777787778777778787111178877777777777777777777777778787111111111111
11111111111178787777777777777778887777777887111178787777777777777778887777777887111178787777777777777777777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777777777777777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777777777777777777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777778887777777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777787878777777777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777877877877777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777877888877777777777777887111111111111
11111111111178877777777777777000777777778787111178877777777777777070777777778787111178877777877777877777777777778787111111111111
11111111111178787777777777777770777777777887111178787777777777777070777777777887111178787777787778777777777777777887111111111111
11111111111178877777777770007000777777778787111178877777777770007000777777778787111178877777778887777777777777778787111111111111
11111111111178787777777777777077777777777887111178787777777777777770777777777887111178787777777777777777777777777887111111111111
11111111111178877777777777777000777777778787111178877777777777777770777777778787111178877777777777777777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787777777777777777777777777887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111178877777777777777777777777778787111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111178787878787878787878787878787887111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111117878787878787878787878787878871111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111117788888888888888888888888888771111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111111177777777777777777777777777111111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111111111111111111111111111111111111111111111111
11111111111178877777778887777777777777778787111178877777778887777777777777778787111111111111111111111111111111111111111111111111
11111111111178787777787778777777777777777887111178787777787778777777777777777887111111111111111111111111111111111111111111111111
11111111111178877777878777877777777777778787111178877777877777877777777777778787111111111111111111111111111111111111111111111111
11111111111178787777877877877777777777777887111178787777877877877777777777777887111111111111111111111111111111111111111111111111
11111111111178877777877777877777777777778787111178877777888777877777777777778787111111111111111111111111111111111111111111111111
11111111111178787777787778777777777777777887111178787777787778777777777777777887111111111111111111111111111111111111111111111111
11111111111178877777778887777777777777778787111178877777778887777777777777778787111111111111111111111111111111111111111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111111111111111111111111111111111111111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111111111111111111111111111111111111111111111111
11111111111178787777777777777777777777777887111178787777777777777777777777777887111111111111111111111111111111111111111111111111
11111111111178877777777777777777777777778787111178877777777777777777777777778787111111111111111111111111111111111111111111111111
11111111111178787878787878787878787878787887111178787878787878787878787878787887111111111111111111111111111111111111111111111111
11111111111117878787878787878787878787878871111117878787878787878787878787878871111111111111111111111111111111111111111111111111
11111111111117788888888888888888888888888771111117788888888888888888888888888771111111111111111111111111111111111111111111111111
11111111111111177777777777777777777777777111111111177777777777777777777777777111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111
11111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111111

